## 9 â€” Django Admin: Customize Admin for Tickets & Users

**Goal:** Make the Django Admin panel more professional, usable, and visually clear for managing **Tickets** and **User Profiles**. Youâ€™ll learn how to enhance list displays, forms, filters, inlines, and layout for better usability â€” essential for real-world Helpdesk management.

---

### ğŸ”¹ Step 1 â€” Understand Why Admin Customization Matters

The Django admin is **not just a developer tool** â€” it can act as a **lightweight management dashboard**.

For the Helpdesk:

* Staff can **view, assign, or close tickets**.
* Admins can **monitor workloads and user profiles**.
* Superusers can **track productivity** or export data.

Default admin views are functional but minimal.
Youâ€™ll now add meaningful layouts, search, and filters for clarity and ease of use.

---

### ğŸ”¹ Step 2 â€” Improve the Ticket Admin Display

Open `helpdesk/admin.py` and edit your `TicketAdmin` class to include better list and form configurations:

```python
from django.contrib import admin
from .models import Ticket, UserProfile

@admin.register(Ticket)
class TicketAdmin(admin.ModelAdmin):
    list_display = (
        "id", 
        "title", 
        "status", 
        "priority", 
        "created_by", 
        "assigned_to", 
        "created_at", 
        "updated_at"
    )
    list_display_links = ("id", "title")
    list_filter = ("status", "priority", "created_at")
    search_fields = ("title", "description", "created_by__username", "assigned_to__username")
    date_hierarchy = "created_at"
    ordering = ("-created_at",)
    readonly_fields = ("created_at", "updated_at")

    # Group fields for clarity
    fieldsets = (
        ("Ticket Information", {
            "fields": ("title", "description", "priority", "status")
        }),
        ("Assignments", {
            "fields": ("created_by", "assigned_to")
        }),
        ("Timestamps", {
            "fields": ("created_at", "updated_at")
        }),
    )
```

âœ… **Features Added:**

* Clean column layout in list view.
* Search bar across tickets.
* Filters by `status` and `priority`.
* Grouped form fields for readability.
* Read-only date fields to avoid accidental edits.

---

### ğŸ”¹ Step 3 â€” Enhance UserProfile Admin with Inline Tickets

Update your `UserProfileAdmin` to show all the userâ€™s related tickets inline (using TabularInline).

```python
class TicketInline(admin.TabularInline):
    model = Ticket
    extra = 0
    fields = ("title", "status", "priority", "assigned_to", "created_at")
    readonly_fields = ("created_at",)
    can_delete = False
    show_change_link = True

@admin.register(UserProfile)
class UserProfileAdmin(admin.ModelAdmin):
    list_display = ("user", "phone", "is_staff_agent")
    list_filter = ("is_staff_agent",)
    search_fields = ("user__username", "user__email", "phone")
    inlines = [TicketInline]
```

âœ… **Now you can:**

* See all tickets for a specific user directly in their profile.
* Quickly navigate from a user to a ticket.
* Identify which users are staff agents.

---

### ğŸ”¹ Step 4 â€” Add a Custom Admin Action for Bulk Updates

Admins often need to mark multiple tickets as â€œClosedâ€ or â€œIn Progressâ€ quickly.

Add this simple custom action inside `TicketAdmin`:

```python
    actions = ["mark_as_closed", "mark_as_in_progress"]

    def mark_as_closed(self, request, queryset):
        count = queryset.update(status=Ticket.STATUS_CLOSED)
        self.message_user(request, f"{count} ticket(s) marked as Closed.")

    def mark_as_in_progress(self, request, queryset):
        count = queryset.update(status=Ticket.STATUS_IN_PROGRESS)
        self.message_user(request, f"{count} ticket(s) marked as In Progress.")
```

âœ… Now, youâ€™ll see new dropdown actions in the admin list view:

> â€œMark selected tickets as Closedâ€
> â€œMark selected tickets as In Progressâ€

ğŸ’¡ *This is extremely helpful for bulk updates.*

---

### ğŸ”¹ Step 5 â€” Test & Polish the Admin Experience

1. **Run the server:**

   ```bash
   python manage.py runserver
   ```

2. **Go to Admin:**
   [http://127.0.0.1:8000/admin/](http://127.0.0.1:8000/admin/)

3. Log in using your superuser credentials.

   * Try filtering tickets by priority/status.
   * Search for a username or keyword.
   * Edit a ticket and see grouped fieldsets.
   * Visit a UserProfile and view their inline tickets.
   * Use bulk actions to update statuses.

4. **Optional polish:** Add a custom header and titles in `config/settings.py` (bottom):

   ```python
   from django.contrib import admin
   admin.site.site_header = "Helpdesk Administration"
   admin.site.site_title = "Helpdesk Admin Portal"
   admin.site.index_title = "Welcome to the Helpdesk Management Interface"
   ```

   Youâ€™ll now see a branded admin panel.

5. **Commit and Push:**

   ```bash
   git add helpdesk/admin.py
   git commit -m "Customize admin for Tickets and UserProfiles with inline tickets and bulk actions"
   git push origin main
   ```

---

### ğŸ§­ Summary

| Step | Action                           | Result                                      |
| ---- | -------------------------------- | ------------------------------------------- |
| 1    | Understood admin importance      | Treat admin as a real tool, not just dev UI |
| 2    | Customized Ticket admin          | Improved usability and clarity              |
| 3    | Added UserProfile inline tickets | Easier relationship management              |
| 4    | Added bulk actions               | Efficient workflow for admins               |
| 5    | Tested and polished interface    | Professional and intuitive admin panel      |

---
